<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="./css/reset.css">
    <link rel="stylesheet" type="text/css" href="./css/pc.css">
    <link rel="stylesheet" media="screen and (max-width: 767px)" type="text/css" href="./css/mobile.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <section id="top">
        <a class="btn-top" href="#top"><img src="./assets/btn_img_top.webp" alt=""></a>
        <div id="leaves">
            <i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i>
        </div>
        <!-- <img class="bg" src="img_pc/NA7_LP_phone_noassets.jpg" alt=""> -->
        <div class="page page-1 active">
            <img class="coin01" src="./assets/img_coin00.webp" alt="">
            <img class="coin02" src="./assets/img_coin00.webp" alt="">
            <img class="coin03" src="./assets/img_coin00.webp" alt="">
            <img class="coin04" src="./assets/img_coin00.webp" alt="">
            <img class="coin05" src="./assets/img_coin00.webp" alt="">
            <img class="coin06" src="./assets/img_coin00.webp" alt="">
            <img class="coin07" src="./assets/img_coin00.webp" alt="">
            <img class="coin08" src="./assets/img_coin00.webp" alt="">
            <img class="coin09" src="./assets/img_coin00.webp" alt="">
            <img class="img-title" src="./assets/img_title.webp" alt="">
            <img class="img-rollercoaster" src="./assets/img_rollercoaster.webp" alt="">
            <a class="btn-link" href="https://tracker.7spin.com/link?btag=39996452_273585"><img class="img-btn" src="./assets/btn1.webp" alt=""></a>
        </div>
        <div class="page page-2">
            <div class="scroll-point"></div>
            <img class="img-title-step" src="assets/img_title_step.webp" alt="">
            <img class="arrow-1" src="assets/img_arrow.webp" alt="">
            <img class="arrow-2" src="assets/img_arrow.webp" alt="">
        </div>
        <div class="page page-3">
            <a class="btn-link" href="https://tracker.7spin.com/link?btag=39996452_234052"><img class="btn-img-ferriswheel" src="assets/btn_img_ferriswheel.webp" alt=""></a>
            <div class="scroll-point"></div>

            <div class="diagram pc">
                <div class="arrow">
                    <img class="phone-img" src="./assets/img_phone01.webp" alt="">
                    <img class="arrow-img" src="./assets/img_arrow.webp" alt="">
                </div>
                <div class="arrow">
                    <img class="phone-img" src="./assets/img_phone02.webp" alt="">
                    <img class="arrow-img" src="./assets/img_arrow.webp" alt="">
                </div>
                <div class="arrow">
                    <img class="phone-img" src="./assets/img_phone03.webp" alt="">
                    <img class="arrow-img" src="./assets/img_arrow.webp" alt="">
                </div>
                <div class="">
                    <img class="phone-img" src="./assets/img_phone04.webp" alt="">
                </div>
                <div class="arrow bottom">
                    <img class="phone-img" src="./assets/img_phone05.webp" alt="">
                    <img class="arrow-img" src="./assets/img_arrow.webp" alt="">
                </div>
                <div class="arrow bottom">
                    <img class="phone-img" src="./assets/img_phone06.webp" alt="">
                    <img class="arrow-img" src="./assets/img_arrow.webp" alt="">
                </div>
                <div class="">
                    <img class="phone-img" src="./assets/img_phone07.webp" alt="">
                </div>
            </div>

            <div class="diagram ph">
                <img class="pre-arrow" src="./assets/img_arrow.webp" alt="">
                <div class="">
                    <img class="phone-img-num" src="./assets/img_number_1.webp" alt="">
                    <img class="phone-img" src="./assets/img_phone01.webp" alt="">
                </div>
                <img class="next-arrow" src="./assets/img_arrow.webp" alt="">
            </div>

        </div>
        <div class="page page-4">
            <div class="scroll-point"></div>
            <img class="img-title-notice" src="assets/img_title_notice.webp" alt="">
        </div>
    </section>

    <script>
        $(document).ready(function () {

            const images = ["./assets/btn1.webp", "./assets/btn2.webp"]; // 图像文件名的数组
            let currentIndex = 0; // 当前图像的索引
            const imgElement = $('.img-btn');

            // 创建一个函数以更改图像
            function changeImage() {
                imgElement.attr('src', images[currentIndex]);
                currentIndex = (currentIndex + 1) % images.length;
            }

            // 每0.8秒调用一次changeImage函数
            const intervalId = setInterval(changeImage, 800);

            let page = 1;
            $(".pre-arrow").click(function(){
                page --
                if (page < 1){
                    page = 7
                }
                changepage(page)
            });
            $(".next-arrow").click(function(){
                page ++
                if (page > 7){
                    page = 1
                }
                changepage(page)
            });

            const myDiv = document.querySelector('.ph');
            let touchStartX = 0;

            myDiv.addEventListener('touchstart', (e) => {
                // 儲存觸控開始位置
                touchStartX = e.touches[0].clientX;
            });

            myDiv.addEventListener('touchend', (e) => {
                // 計算觸控滑動的距離
                const touchEndX = e.changedTouches[0].clientX;
                const deltaX = touchEndX - touchStartX;

                // 橫向滑動
                if (deltaX > 10) {
                    page --
                    if (page < 1){
                        page = 7
                    }
                    changepage(page)
                } else if (deltaX < -10) {
                    page ++
                    if (page > 7){
                        page = 1
                    }
                    changepage(page)
                }
                // 重設觸控開始位置，以便下一次計算
                touchStartX = touchEndX;
            });

            function changepage(page){
                if(page == 7){
                    $(".ph .phone-img-num").css("display", "none");
                }else{
                    $(".ph .phone-img-num").css("display", "block");
                    $(".ph .phone-img-num").attr('src', './assets/img_number_' + page + '.webp');
                }
                $(".ph .phone-img").attr('src', './assets/img_phone0' + page + '.webp');
            }

            //設定observer api 選項
            //root預設就是視窗
            const options = {
                rootMargin: '0px 0px -200px 0px',
                threshold: 0
            }

            //選定要觀察的對象
            const scrollPoints = document.querySelectorAll('.scroll-point')

            //設定call back
            const callback = (entries, observer) => {
                entries.forEach(entry => {
                    if (entry.intersectionRatio <= 0) {
                        // console.log("out") //消失
                    } else { 
                        const parentElement = entry.target.parentElement;
                        parentElement.classList.add('active');
                    }
                })
            }

            //創建新的觀察API
            let observer = new IntersectionObserver(callback, options);

            // 遍歷每個 'scroll-point' 元素並觀察它們
            scrollPoints.forEach(scrollPoint => {
                observer.observe(scrollPoint);
            });

        });

        window.onload = (event) => {
            btnLink = document.querySelectorAll(".btn-link")
            for(let i=0;i<btnLink.length;i++){
                webPid = "https://tracker.7spin.com/link" + window.location.search;
                btnLink[i].href = webPid;
            }
        };
        
        // 定义一个变量来标记是否可以执行滚动处理
        let canScroll = true;

        // 定义节流时间间隔（毫秒）
        const throttleInterval = 500; // 例如，500毫秒

        // 监听滚动事件
        window.addEventListener("scroll", function() {
            // 检查是否可以执行滚动处理
            if (!canScroll) {
                return; // 如果不能执行，则退出
            }

            // 设置 canScroll 为 false，防止在时间间隔内重复触发
            canScroll = false;

            // 在节流时间间隔后重置 canScroll 为 true，以便下次触发滚动事件
            setTimeout(function() {
                canScroll = true;
            }, throttleInterval);

            // 在滚动到特定位置时执行某个函数
            if (window.scrollY >= 500) {
                $('.btn-top').css("display", "block");
            }else {
                $('.btn-top').css("display", "none");
            }
        });

        function yourFunction() {
            $('.btn-top').css("display", "block");
        }
    </script>
</body>
</html>